<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Sound</title>
  <script src="js/p5.min.js"></script>
  <script src="js/p5.sound.js"></script>
</head>
<body>

  <script>
  var A1;
  var fft;
  var filter;

  // プリロード
  function preload() {
    A1 = loadSound('audio/FWDL.mp3');
  }


  function setup() {
    createCanvas(900, 600);


    // ボリューム
    // A1.setVolume(0.5);

    fill(200,200,255);
    filter = new p5.BandPass();

    A1.disconnect();
    A1.connect(filter);


    fft = new p5.FFT(0.8, 64);
    filter.connect(fft);

    A1.loop();

  }

  function draw(){
    var freq = map(mouseX, 0, width, 10, 22050);
    filter.freq(freq);

    var res = map(mouseY, 0, height, 0, 10);
    filter.res(res);

    var spectrum = fft.analyze();

    background(230);
    for (var i = 0; i < spectrum.length; i++) {
      var x = map(i, 0, spectrum.length, 0, width);
      var h = map(spectrum[i], 0, 255, 0, height);
      rect(x, height, width/spectrum.length, -h);
    }
  }

  // play sound on mouse press over canvas
  function mousePressed() {
    if (mouseX < width && mouseY < height && mouseX > 0 && mouseY > 0) {
      // プレイ
      A1.play();
    }
  }

  </script>

</body>
</html>
